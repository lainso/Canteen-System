import{_ as te}from"./logo_circle-CFpan6rn.js";import{b as se,q as ae,r as ne,c as ue}from"./shop-gK-aVV9D.js";import{r as h,u as de,a as q,h as re,i as ie,w as o,f as i,o as pe,e,d as p,j as v,b as s,t as g,k as _e,l as me,D as fe,I as ce,s as he,K as ve,A as ge,B as Ve,p as be,g as we}from"./index-Cry4P2XB.js";import{u as ye}from"./userStore-CzWJ6rJP.js";import{_ as xe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./request-DFAhraQF.js";const d=$=>(be("data-v-a77e355f"),$=$(),we(),$),ke=d(()=>s("img",{style:{width:"60px","margin-left":"2rem"},src:te,alt:"logo"},null,-1)),Ce=d(()=>s("div",{class:"flex-grow"},null,-1)),$e=d(()=>s("br",null,null,-1)),Ie=d(()=>s("span",null,"首页",-1)),Ue=d(()=>s("span",null,"订单管理",-1)),Se=d(()=>s("span",null,"雇员管理",-1)),qe=d(()=>s("span",null,"菜品管理",-1)),Ae=d(()=>s("span",null,"账 号 设 置",-1)),Re={class:"card-header"},ze={class:"header-title"},Fe={class:"header-buttons"},Ge=d(()=>s("span",null,"商户不支持自行注销账号，若有需求请联系管理员。",-1)),Ze={class:"dialog-footer"},Ne={class:"dialog-footer"},Oe=d(()=>s("br",null,null,-1)),Be=d(()=>s("br",null,null,-1)),De=d(()=>s("br",null,null,-1)),Ee=d(()=>s("br",null,null,-1)),je=d(()=>s("br",null,null,-1)),Me=d(()=>s("p",null,"商户修改密码需要验证旧密码：",-1)),Je=d(()=>s("br",null,null,-1)),Pe={class:"dialog-footer"},Te=d(()=>s("span",null,"发送链接与邀请码给新员工可快速添加员工到本店。",-1)),Ke=d(()=>s("br",null,null,-1)),He=d(()=>s("br",null,null,-1)),Le={class:"dialog-footer"},Qe={__name:"me",setup($){const B=h("1"),V=de(),R=ye().getUsername,r=h({}),y=h(!1),I=h(!1),x=h(!1),k=h(!1),A=h(),z=h(),n=q({shop_name:"",shop_head:"",shop_tel:"",shop_pass:"",email:"",cus_address:""}),_=q({new_pass:"",old_pass:"",re_pass:""}),D=(u,l,a)=>{_.re_pass===_.new_pass?a():a(new Error("两次输入的新密码不一致"))},E=q({shop_name:[{required:!0,message:"店铺名称不能为空",trigger:"blur"}],shop_tel:[{required:!0,message:"联系电话不能为空",trigger:"blur"}],shop_pass:[{required:!0,message:"店铺邀请码不能为空",trigger:"blur"}],email:[{required:!0,message:"电子邮箱不能为空",trigger:"blur"},{validator:(u,l,a)=>{var b=/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(\.[a-zA-Z0-9_-])+/,C=/^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{2,4})$/;!b.test(l)&&l!=""||!C.test(l)&&l!=""?a(new Error("请输入正确的邮箱格式")):a()},message:"请输入正确的邮箱格式",trigger:["blur"]}]}),j=q({old_pass:[{required:!0,message:"旧密码不能为空",trigger:"blur"}],new_pass:[{required:!0,message:"新密码不能为空",trigger:"blur"}],re_pass:[{required:!0,message:"请再次输入新密码",trigger:"blur"},{validator:D,message:"两次输入的新密码不一致",trigger:["blur"]}]}),M=()=>{const u=window.location.protocol,l=window.location.hostname,a=window.location.port?`:${window.location.port}`:"",b="【内部餐饮系统】"+r.value.shop_name+` 邀请您加入他们的团队，请点击链接完成加入：${u}//${l}${a}/#/joinShop
邀请码：`+r.value.shop_pass;x.value=!1,navigator.clipboard.writeText(b).then(()=>{alert("链接和邀请码已复制到剪切板！")}).catch(C=>{alert("复制失败： ",C)})},J=u=>{u&&u.validate(l=>{if(l)ae(R,_.old_pass,_.new_pass).then(function(a){alert("修改密码成功，请重新登录！"),console.log(a),y.value=!1,U()}).catch(function(a){console.log(a)});else return!1})},P=(u,l)=>{ne(u,l).then(function(a){console.log(a),confirm("提交成功，新信息将在下次登录后更新！是否重新登录？")&&U()}).catch(function(a){console.log(a)})},T=u=>{se(u).then(function(l){r.value=l,localStorage.setItem("userInfo",JSON.stringify(l))}).catch(function(l){console.log(l)})},K=()=>{n.shop_name=r.value.shop_name,n.shop_head=r.value.shop_head,n.shop_tel=r.value.shop_tel,n.shop_pass=r.value.shop_pass,n.email=r.value.email,n.cus_address=r.value.cus_address};re(()=>{const u=localStorage.getItem("userInfo");u?r.value=JSON.parse(u):T(R)});const F=u=>{u.resetFields()},G=()=>{V.push("/shop/index")},H=()=>{V.push("/shop/addOrder")},L=()=>{V.push("/shop/order")},Q=()=>{V.push("/shop/me")},W=()=>{V.push("/shop/dish")},X=()=>{V.push("/shop/emp")},U=()=>{localStorage.removeItem("userInfo"),ue().then(function(u){console.log(u)}).catch(function(u){console.log(u)})};return(u,l)=>{const a=i("el-menu-item"),b=i("el-menu"),C=i("el-header"),w=i("el-icon"),Z=i("el-sub-menu"),Y=i("el-col"),ee=i("el-row"),m=i("el-button"),S=i("el-dialog"),f=i("el-input"),c=i("el-form-item"),N=i("el-form"),le=i("el-card"),oe=i("el-main"),O=i("el-container");return pe(),ie(O,{style:{height:"100vh"}},{default:o(()=>[e(C,{class:"header-menu"},{default:o(()=>[e(b,{"default-active":B.value,class:"el-menu-demo",mode:"horizontal",ellipsis:!1},{default:o(()=>[ke,e(a,{onClick:G,index:"1",style:{"font-weight":"bold","margin-left":"3rem"}},{default:o(()=>[p(" 内 部 餐 饮 系 统 - 商 户 端 ")]),_:1}),Ce,e(a,{index:"2",onClick:U},{default:o(()=>[p("退 出 登 录")]),_:1})]),_:1},8,["default-active"])]),_:1}),e(O,null,{default:o(()=>[e(ee,{class:"tac"},{default:o(()=>[e(Y,{span:24},{default:o(()=>[$e,e(b,{"default-active":"5",class:"el-menu-vertical-demo"},{default:o(()=>[e(a,{index:"1",onClick:G},{default:o(()=>[e(w,null,{default:o(()=>[e(v(_e))]),_:1}),Ie]),_:1}),e(Z,{index:"2"},{title:o(()=>[e(w,null,{default:o(()=>[e(v(me))]),_:1}),Ue]),default:o(()=>[e(a,{index:"2-1",onClick:H},{default:o(()=>[p("下单")]),_:1}),e(a,{index:"2-2",onClick:L},{default:o(()=>[p("订单管理")]),_:1})]),_:1}),e(a,{index:"3",onClick:X},{default:o(()=>[e(w,null,{default:o(()=>[e(v(fe))]),_:1}),Se]),_:1}),e(a,{index:"4",onClick:W},{default:o(()=>[e(w,null,{default:o(()=>[e(v(ce))]),_:1}),qe]),_:1}),e(Z,{index:"5"},{title:o(()=>[e(w,null,{default:o(()=>[e(v(he))]),_:1}),Ae]),default:o(()=>[e(a,{index:"5-1",onClick:Q},{default:o(()=>[p("个 人 中 心")]),_:1}),e(a,{index:"5-2",onClick:U},{default:o(()=>[p("退 出 账 号")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(oe,{style:{display:"flex","justify-content":"center","align-items":"center",height:"100%"}},{default:o(()=>[e(le,{class:"box-card",shadow:"hover"},{header:o(()=>[s("div",Re,[e(w,null,{default:o(()=>[e(v(ve))]),_:1}),s("span",ze,g(r.value.shop_name),1),s("div",Fe,[e(m,{type:"primary",onClick:l[0]||(l[0]=t=>{k.value=!0,K()}),icon:v(ge),circle:""},null,8,["icon"]),e(m,{type:"danger",onClick:l[1]||(l[1]=t=>I.value=!0),icon:v(Ve),circle:""},null,8,["icon"])])])]),footer:o(()=>[e(m,{type:"success",onClick:l[13]||(l[13]=t=>x.value=!0)},{default:o(()=>[p("查看邀请码")]),_:1}),e(m,{type:"warning",onClick:l[14]||(l[14]=t=>y.value=!0)},{default:o(()=>[p("修改密码")]),_:1}),e(S,{style:{"margin-right":"58vh","margin-top":"34vh"},modelValue:y.value,"onUpdate:modelValue":l[20]||(l[20]=t=>y.value=t),title:"修改密码",width:"500"},{footer:o(()=>[s("div",Pe,[e(m,{onClick:l[18]||(l[18]=t=>{y.value=!1,F(A.value)})},{default:o(()=>[p("取消")]),_:1}),e(m,{type:"warning",onClick:l[19]||(l[19]=t=>J(A.value))},{default:o(()=>[p(" 确认 ")]),_:1})])]),default:o(()=>[Me,Je,e(N,{ref_key:"ruleFormRef",ref:A,model:_,rules:j,"label-width":"20%",class:"demo-form","status-icon":""},{default:o(()=>[e(c,{label:"旧密码",prop:"old_pass"},{default:o(()=>[e(f,{type:"password",modelValue:_.old_pass,"onUpdate:modelValue":l[15]||(l[15]=t=>_.old_pass=t)},null,8,["modelValue"])]),_:1}),e(c,{label:"新密码",prop:"new_pass"},{default:o(()=>[e(f,{type:"password",modelValue:_.new_pass,"onUpdate:modelValue":l[16]||(l[16]=t=>_.new_pass=t)},null,8,["modelValue"])]),_:1}),e(c,{label:"确认密码",prop:"re_pass"},{default:o(()=>[e(f,{type:"password",modelValue:_.re_pass,"onUpdate:modelValue":l[17]||(l[17]=t=>_.re_pass=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),e(S,{style:{"margin-right":"58vh","margin-top":"40vh"},modelValue:x.value,"onUpdate:modelValue":l[22]||(l[22]=t=>x.value=t),title:"查看邀请码",width:"500"},{footer:o(()=>[s("div",Le,[e(m,{onClick:l[21]||(l[21]=t=>x.value=!1)},{default:o(()=>[p("取消")]),_:1}),e(m,{type:"success",onClick:M},{default:o(()=>[p(" 复制到剪切板 ")]),_:1})])]),default:o(()=>[Te,Ke,He,s("p",null,"邀请码："+g(r.value.shop_pass),1)]),_:1},8,["modelValue"])]),default:o(()=>[e(S,{style:{"margin-right":"58vh","margin-top":"40vh"},modelValue:I.value,"onUpdate:modelValue":l[3]||(l[3]=t=>I.value=t),title:"敬告",width:"500"},{footer:o(()=>[s("div",Ze,[e(m,{type:"danger",onClick:l[2]||(l[2]=t=>{I.value=!1})},{default:o(()=>[p(" 确认 ")]),_:1})])]),default:o(()=>[Ge]),_:1},8,["modelValue"]),e(S,{style:{"margin-right":"58vh","margin-top":"25vh"},modelValue:k.value,"onUpdate:modelValue":l[12]||(l[12]=t=>k.value=t),title:"修改资料",width:"500"},{footer:o(()=>[s("div",Ne,[e(m,{onClick:l[10]||(l[10]=t=>{k.value=!1,F(z.value)})},{default:o(()=>[p("取消")]),_:1}),e(m,{type:"primary",onClick:l[11]||(l[11]=t=>{k.value=!1,P(r.value.username,n)})},{default:o(()=>[p(" 确认 ")]),_:1})])]),default:o(()=>[e(N,{ref_key:"ruleFormRef2",ref:z,model:n,rules:E,"label-width":"20%",class:"demo-form","status-icon":""},{default:o(()=>[e(c,{label:"店铺名称",prop:"shop_name"},{default:o(()=>[e(f,{modelValue:n.shop_name,"onUpdate:modelValue":l[4]||(l[4]=t=>n.shop_name=t),autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(c,{label:"店长",prop:"shop_head"},{default:o(()=>[e(f,{modelValue:n.shop_head,"onUpdate:modelValue":l[5]||(l[5]=t=>n.shop_head=t),autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(c,{label:"联系电话",prop:"shop_tel"},{default:o(()=>[e(f,{modelValue:n.shop_tel,"onUpdate:modelValue":l[6]||(l[6]=t=>n.shop_tel=t),autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(c,{label:"邀请码",prop:"shop_pass"},{default:o(()=>[e(f,{modelValue:n.shop_pass,"onUpdate:modelValue":l[7]||(l[7]=t=>n.shop_pass=t),autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(c,{label:"电子邮件",prop:"email"},{default:o(()=>[e(f,{modelValue:n.email,"onUpdate:modelValue":l[8]||(l[8]=t=>n.email=t),autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(c,{label:"店铺地址",prop:"cus_address"},{default:o(()=>[e(f,{modelValue:n.cus_address,"onUpdate:modelValue":l[9]||(l[9]=t=>n.cus_address=t),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]),s("p",null,g("登录账号： "+r.value.username),1),Oe,s("p",null,g("店长： "+r.value.shop_head),1),Be,s("p",null,g("店铺电话： "+r.value.shop_tel),1),De,s("p",null,g("电子邮件： "+r.value.email),1),Ee,s("p",null,g("店铺地址： "+r.value.cus_address),1),je]),_:1})]),_:1})]),_:1})]),_:1})}}},sl=xe(Qe,[["__scopeId","data-v-a77e355f"]]);export{sl as default};
