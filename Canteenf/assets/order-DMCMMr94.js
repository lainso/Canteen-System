import{_ as ie}from"./logo_circle-CFpan6rn.js";import{r as u,u as ue,a as I,h as ce,i as _e,w as o,f as n,o as me,e,d as r,j as v,b as s,t as pe,k as fe,l as he,D as ge,I as ve,s as be,p as we,g as ye}from"./index-BA2o8hTc.js";import{u as ke}from"./userStore-DWnd3T38.js";import{h as xe,i as Ce,c as Ve}from"./shop-BXYZQcQE.js";import{_ as Ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./request-IzQaM4-z.js";const i=b=>(we("data-v-01f7883d"),b=b(),ye(),b),$e=i(()=>s("img",{style:{width:"60px","margin-left":"2rem"},src:ie,alt:"logo"},null,-1)),Oe=i(()=>s("div",{class:"flex-grow"},null,-1)),De=i(()=>s("br",null,null,-1)),Ge=i(()=>s("span",null,"首页",-1)),Re=i(()=>s("span",null,"订单管理",-1)),Se=i(()=>s("span",null,"雇员管理",-1)),Ue=i(()=>s("span",null,"菜品管理",-1)),ze=i(()=>s("span",null,"账 号 设 置",-1)),Ee={class:"form-wrapper"},Fe={class:"search-area"},Ne=i(()=>s("br",null,null,-1)),Be=i(()=>s("br",null,null,-1)),je={class:"pagination-container"},Me=i(()=>s("p",null,"商户只可以修改订单状态。",-1)),Pe=i(()=>s("br",null,null,-1)),Te={class:"dialog-footer"},qe={__name:"order",setup(b){const F=u("1"),_=ue(),$=u([]),N=ke().getUsername,O=u(1),C=u(null),B=u(null),m=u(null),p=u(!1),D=u(0),j=({row:t,rowIndex:l})=>t.ord_condition==="已支付"?"warning-row":t.ord_condition==="已完成"?"success-row":t.ord_condition==="已取消"?"danger-row":"",f=I({key:""}),w=I({ord_condition:""}),M=I({ord_condition:[{required:!0,message:"订单状态不能为空",trigger:"blur"}]}),y=(t,l)=>{xe(t,7,l,N).then(function(a){$.value=a.data.map(k=>k),D.value=a.total}).catch(function(a){console.log(a)})},P=t=>t.map(l=>`${l.dish_name} × ${l.orderlist_num}`).join("，");ce(()=>{y("",1)});const T=t=>{y(t,1)};function q(t){C.value=t,p.value=!0}function A(){!m.value||!C.value||m.value.validate(t=>{if(t){let l={ord_condition:w.ord_condition};const a=C.value.ord_number;L(a,l),p.value=!1}else console.log("编辑表单验证失败")})}const L=(t,l)=>{Ce(t,l).then(function(a){alert("修改成功"),console.log(a),y("",1)}).catch(function(a){console.log(a)}),S()},H=t=>{y(f.key,t)},G=()=>{_.push("/shop/index")},J=()=>{_.push("/shop/addOrder")},K=()=>{_.push("/shop/order")},Q=()=>{_.push("/shop/me")},W=()=>{_.push("/shop/dish")},X=()=>{_.push("/shop/emp")},R=()=>{localStorage.removeItem("userInfo"),Ve().then(function(t){console.log(t)}).catch(function(t){console.log(t)})},S=()=>{m.value&&m.value.resetFields()};return(t,l)=>{const a=n("el-menu-item"),k=n("el-menu"),Y=n("el-header"),h=n("el-icon"),U=n("el-sub-menu"),Z=n("el-col"),ee=n("el-row"),oe=n("el-input"),V=n("el-form-item"),g=n("el-button"),z=n("el-form"),te=n("el-card"),c=n("el-table-column"),le=n("el-tooltip"),ne=n("el-table"),ae=n("el-pagination"),x=n("el-option"),se=n("el-select"),de=n("el-dialog"),re=n("el-main"),E=n("el-container");return me(),_e(E,{style:{height:"100vh"}},{default:o(()=>[e(Y,{class:"header-menu"},{default:o(()=>[e(k,{"default-active":F.value,class:"el-menu-demo",mode:"horizontal",ellipsis:!1},{default:o(()=>[$e,e(a,{onClick:G,index:"1",style:{"font-weight":"bold","margin-left":"3rem"}},{default:o(()=>[r(" 内 部 餐 饮 系 统 - 商 户 端 ")]),_:1}),Oe,e(a,{index:"2",onClick:R},{default:o(()=>[r("退 出 登 录")]),_:1})]),_:1},8,["default-active"])]),_:1}),e(E,null,{default:o(()=>[e(ee,{class:"tac"},{default:o(()=>[e(Z,{span:24},{default:o(()=>[De,e(k,{"default-active":"2",class:"el-menu-vertical-demo"},{default:o(()=>[e(a,{index:"1",onClick:G},{default:o(()=>[e(h,null,{default:o(()=>[e(v(fe))]),_:1}),Ge]),_:1}),e(U,{index:"2"},{title:o(()=>[e(h,null,{default:o(()=>[e(v(he))]),_:1}),Re]),default:o(()=>[e(a,{index:"2-1",onClick:J},{default:o(()=>[r("下单")]),_:1}),e(a,{index:"2-2",onClick:K},{default:o(()=>[r("订单管理")]),_:1})]),_:1}),e(a,{index:"3",onClick:X},{default:o(()=>[e(h,null,{default:o(()=>[e(v(ge))]),_:1}),Se]),_:1}),e(a,{index:"4",onClick:W},{default:o(()=>[e(h,null,{default:o(()=>[e(v(ve))]),_:1}),Ue]),_:1}),e(U,{index:"5"},{title:o(()=>[e(h,null,{default:o(()=>[e(v(be))]),_:1}),ze]),default:o(()=>[e(a,{index:"5-1",onClick:Q},{default:o(()=>[r("个 人 中 心")]),_:1}),e(a,{index:"5-2",onClick:R},{default:o(()=>[r("退 出 账 号")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(re,{style:{"background-image":"none",display:"block",height:"auto"}},{default:o(()=>[e(te,{class:"box-card",shadow:"hover"},{default:o(()=>[s("div",Ee,[s("div",Fe,[e(z,{inline:!0,model:f,"label-width":"20%",class:"demo-form-inline search-form","status-icon":""},{default:o(()=>[e(V,{label:"订单时间",prop:"key","label-width":"100px"},{default:o(()=>[e(oe,{modelValue:f.key,"onUpdate:modelValue":l[0]||(l[0]=d=>f.key=d),style:{width:"350px"},clearable:"",placeholder:"例：2024-01-01"},null,8,["modelValue"])]),_:1}),e(V,null,{default:o(()=>[e(g,{onClick:l[1]||(l[1]=d=>T(f.key)),type:"primary"},{default:o(()=>[r("搜索")]),_:1})]),_:1})]),_:1},8,["model"])])])]),_:1}),Ne,e(ne,{data:$.value,style:{width:"100%"},"row-class-name":j},{default:o(()=>[e(c,{prop:"ord_time",label:"订单时间",width:"180"}),e(c,{prop:"username",label:"顾客账号",width:"150"}),e(c,{prop:"ord_condition",label:"订单状态",width:"150"}),e(c,{prop:"ord_money",label:"订单金额",width:"150"}),e(c,{label:"订单内容"},{default:o(d=>[r(pe(P(d.row.orderlist)),1)]),_:1}),e(c,{prop:"ord_number",label:"订单号",width:"180"}),e(c,{label:"操作",width:"150"},{default:o(d=>[e(g,{type:"primary",size:"small",onClick:Ae=>q(d.row)},{default:o(()=>[r("编辑")]),_:2},1032,["onClick"]),e(le,{class:"box-item",effect:"dark",content:"商户禁止删除订单，可前往编辑修改订单状态",placement:"top-end"},{default:o(()=>[e(g,{disabled:"",size:"small",type:"danger"},{default:o(()=>[r("删除")]),_:1})]),_:1})]),_:1})]),_:1},8,["data"]),Be,s("div",je,[e(ae,{"current-page":O.value,"onUpdate:currentPage":l[2]||(l[2]=d=>O.value=d),"page-size":7,layout:"prev, pager, next",total:D.value,onCurrentChange:H},null,8,["current-page","total"])]),e(de,{style:{"margin-right":"58vh","margin-top":"35vh"},modelValue:p.value,"onUpdate:modelValue":l[5]||(l[5]=d=>p.value=d),title:"修改订单状态",width:"500"},{footer:o(()=>[s("div",Te,[e(g,{onClick:l[4]||(l[4]=d=>{p.value=!1,S(B.value)})},{default:o(()=>[r("取消")]),_:1}),e(g,{type:"primary",onClick:A},{default:o(()=>[r(" 确认修改 ")]),_:1})])]),default:o(()=>[Me,Pe,e(z,{ref_key:"ruleFormRef3",ref:m,model:w,rules:M,"label-width":"17%",class:"demo-form","status-icon":""},{default:o(()=>[e(V,{label:"订单状态",prop:"ord_condition"},{default:o(()=>[e(se,{modelValue:w.ord_condition,"onUpdate:modelValue":l[3]||(l[3]=d=>w.ord_condition=d)},{default:o(()=>[e(x,{label:"未支付",value:"未支付"}),e(x,{style:{color:"orange"},label:"已支付",value:"已支付"}),e(x,{style:{color:"green"},label:"已完成",value:"已完成"}),e(x,{style:{color:"red"},label:"已取消",value:"已取消"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})}}},Xe=Ie(qe,[["__scopeId","data-v-01f7883d"]]);export{Xe as default};
